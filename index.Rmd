
---
title: "Neighborhood Disadvantage and Crime Variation Over Time"
author: Olivia Delos
---

# Introduction
Crime rates have decreased for all types of crime since the 1990s, although most considerably for violent crimes (Papachristos 2013). However, crime rates vary depending on the social composition of a neighborhood. Disadvantaged neighborhoods are disproportionately low-income with weak social ties and high residential instability (Zuberi 2012). The concentration of poverty, violence, and high policing in disadvantaged neighborhoods hinder residents’ ability to form social cohesion and community organization, increasing residents’ risk of victimization and limiting social control (Van Wilsem, Wittebrood, De Graaf 2006). Disadvantaged neighborhoods are also often policed at higher rates than their counterparts. The high poverty and policing combined with lack of social control and low social cohesion in disadvantaged neighborhoods leads to increased crime rates in these areas (Van Wilsem et al. 2006). Violent crime, in particular, is more prevalent in urban, disadvantaged neighborhoods (Friedson and Sharkey 2015). However, few studies have examined whether the type of crimes committed in disadvantaged neighborhoods are different from those committed in less disadvantaged areas. By examining census data and crime data from Buffalo, New York I want to answer three questions: 1) Are the types of crime being committed in low-income census tracts different from those in higher income tracts? 2) Have census tracts witnessed an overall decrease in crime between 2010 and 2017? 3) If so, does the decrease differ by crime type? To answer my questions, I will compare crime rates by type of crime incident between 2006-2010 to crime rates in 2013-2017. I measure neighborhood disadvantage using census tract data in Buffalo, New York on median income from the 2010 and 2017 ACS. Crime data comes from the public PenData Buffalo and can be broken into six categories: assault, breaking and entering, homicide, sexual offenses, robbery, and theft. I predict that, although crime rates for all types are likely higher in lower income neighborhoods, violent crimes will be more common, while theft and other offenses are more likely to occur than violent crimes in higher income neighborhoods and that crimes rates have likely decreased in all tracts, but more so for violent crimes, as opposed to property crimes.


# Materials and methods

1. Load required packages
2. Download crime data from buffalony.gov and 2010 and 2017 ACS estimates for income data in Erie County
3. Clean and join data
4. Run regression on types of crime and income level
5. Create figures

## 1. Load required packages.
```{r, message=F, warning=F}
library(tidycensus)
library(tidyverse)
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(seg)
library(sf)
library(tigris)
library(plotly)
```

## 2. Download the data

```{r, results="hide", cache = TRUE}
#Load crime data
crimesf=read_sf("https://data.buffalony.gov/api/geospatial/d6g9-xbgu?method=export&format=GeoJSON")

#Load 2017 census data
v17 <- load_variables(year = 2017, dataset = "acs5", cache = TRUE)

med_income2017 <- get_acs(geography = "tract",
                        variables = "B06011_001",
                       state = "NY",
                       county = "Erie",
                       year = 2017,
                       geometry = TRUE)


# Load 2010 census data
v10 <- load_variables(year = 2010, dataset = "acs5", cache = TRUE)

med_income2010 <- get_acs(geography = "tract",
                        variables = "B19013_001",
                       state = "NY",
                       county = "Erie",
                       year = 2010,
                       geometry = TRUE)

```

``` {r, results = "hide", cache = TRUE}

#Crop census data to city limits
income_crop2017 <- med_income2017[c(1:70, 228, 229, 221:227),]
income_crop2010 <- med_income2010[c(1:70, 228, 229, 221:227),]

#Transform crime geometry to match census tract
crimetrans <- st_transform(crimesf, st_crs(income_crop2017))

inc_tracts <- st_join(crimetrans, select(med_income2017,NAME), st_intersects)

```

## 3. Clean crime data
```{r, cache = TRUE}
#extract year from date
crime_date <- ymd_hms(inc_tracts$incident_datetime) %>%
    year()
  
crime_year <- cbind(crime_date, inc_tracts, stringsAsFactors = FALSE)

#Recategorize crime types
crime_year$parent_incident_type <- as.factor(crime_year$parent_incident_type) %>%
  fct_collapse(crime_year$parent_incident_type, 
                  Theft = c("Theft of Vehicle", "Theft"),
                  Sexual_Offenses = c("Sexual Assault", "Other Sexual Offense"),
                  Breaking_entering = "Breaking & Entering",
                  Assault = "Assault",
                  Homicide = "Homicide",
                  Robbery = "Robbery")

#clean/filter crime data, drop geometry
crime2017 <- crime_year %>%
     filter(crime_date >= 2013 & crime_date <= 2017) %>%
     group_by(NAME, parent_incident_type) %>%
    summarize(total = n()) %>%
    st_set_geometry(NULL)


c2017_spread <- spread(crime2017, parent_incident_type, total)

c2017_spread[is.na(c2017_spread)] <- 0

#Do the same for 2010
crime2010 <- crime_year %>%
     filter(crime_date >= 2006 & crime_date <= 2010) %>%
     group_by(NAME, parent_incident_type) %>%
    summarize(total = n()) %>%
    st_set_geometry(NULL)

c2010_spread <- spread(crime2010, parent_incident_type, total) %>%
    select(-V6)

c2010_spread[is.na(c2010_spread)] <- 0

```

# Clean income data and join datasets
```{r, cache = TRUE}
#Remove and rename columns
income_clean17 <- income_crop2017 %>%
  select(-moe, -variable)

income_clean10 <- income_crop2010 %>%
  select(-moe, -variable)

colnames(income_clean10)[3] <- "MedianInc"
colnames(income_clean17)[3] <- "MedianInc"
  
crime_income2017 <- left_join(income_clean17, c2017_spread, by = c("NAME" = "NAME"))

crime_income2010 <- left_join(income_clean10, c2010_spread, by = c("NAME" = "NAME"))

#st_geometry(crime_income2017) <- crime_income2017$geometry
#st_geometry(crime_income2010) <- crime_income2010$geometry

#Find mean crime per tract
crimeAvg2017 <- crime_income2017 %>%
  group_by(NAME, MedianInc) %>%
  summarize(meancrime = mean(c(Assault, Breaking_entering, Homicide, Sexual_Offenses, Robbery, Theft)))

crimeAvg2010 <- crime_income2010 %>%
  group_by(NAME, MedianInc) %>%
  summarize(meancrime = mean(c(Assault, Breaking_entering, Homicide, Sexual_Offenses, Robbery, Theft)))

```


## 4. Run regression
```{r, results='asis', cache = TRUE}
#2010 regression
regress2010 <- lm(MedianInc~Theft+Sexual_Offenses+Breaking_entering+Assault+Homicide+Robbery, data = crime_income2010)
summary(regress2010)
```

``` {r, results = 'asis', cache = TRUE}
#2017 regression
regress2017 <- lm(MedianInc~Theft+Sexual_Offenses+Breaking_entering+Assault+Homicide+Robbery, data = crime_income2017)
summary(regress2017)

#Plot relationship between crime and income 2017
ggplot(crime_income2017) + geom_point(aes(x = MedianInc, y = total, color = parent_incident_type))
```

# Results


## Plot median income for both years
This figure is a map of median income estimates for 2017 by census tracts in Buffalo, NY
```{r, fig.width=10, fig.height=5, fig.cap="Map of median income by census tract"}

crime_income2010 %>%
  ggplot(aes(fill = MedianInc)) +
  geom_sf() + scale_fill_viridis_c()

#Crime over time

#maybe average crime types group by year and then summarize across tracts
#ggplot(crime2010) + geom_line(aes(x = crime_date, y = total, color = parent_incident_type, group = NAME))

```

This figure is a map of crime by type in 2017

```{r}
crime_income2017 %>% 
  ggplot(aes(fill = MedianInc)) +
  geom_sf() + scale_fill_viridis_c()
```
# Conclusions



# References

Friedson, Michael and Patrick Sharkey. 2015. "Violence and Neighborhood Disadvantage after the Crime Decline." *The American Academy of Political & Social Science* 660. 

Papachristos, Andrew V. 2013. "48 Years of Crime in Chicago: A Descriptive Analysis of Serious Crime Trends from 1965 to 2013." *Institution for Social and Policy Studies*. 

Van Wilsem, Johan. Karin Whitebrood, Nan Dirk De Graaf. 2006. "Socioeconomic Dynamics of Neighborhoods and the Risk of Crime Victimization: A Multilevel Study of Improving, Declining, and Stable Areas in the Netherlands." *Social Problems* 53(2):226-247.

Zuberi, Anita. 2012. “Neighborhood Poverty and Children’s Exposure to Danger: Examining Gender Differences in Impacts of the Moving to Opportunity Experiment.” *Social Science Research* 41:788-801.